function doGet(e) {
  var action = e.parameter.action;
  var sheetName;
  
  // Tentukan sheet berdasarkan action
  switch(action) {
    case 'getBimbingan':
      sheetName = 'Bimbingan';
      break;
    case 'getSkripsiFinal':
      sheetName = 'SkripsiFinal';
      break;
    case 'getEarlyWarning':
      sheetName = 'EarlyWarning';
      break;
    case 'getSkripsi':
    default:
      sheetName = 'Skripsi';
      break;
  }
  
  try {
    // Ganti dengan ID spreadsheet Anda
    var spreadsheetId = '1DkWgjb6jVQ96cSd6oP9k00vo9NYiWwGt7ZI8CGcMm0';
    var sheet = SpreadsheetApp.openById(spreadsheetId).getSheetByName(sheetName);
    
    if (!sheet) {
      return ContentService.createTextOutput(JSON.stringify({error: 'Sheet not found'}))
        .setMimeType(ContentService.MimeType.JSON);
    }
    
    var data = sheet.getDataRange().getValues();
    var headers = data[0];
    
    var jsonData = [];
    for (var i = 1; i < data.length; i++) {
      var row = data[i];
      var record = {};
      for (var j = 0; j < headers.length; j++) {
        record[headers[j]] = row[j];
      }
      jsonData.push(record);
    }
    
    return ContentService.createTextOutput(JSON.stringify(jsonData))
      .setMimeType(ContentService.MimeType.JSON)
      .setHeader('Access-Control-Allow-Origin', '*');
  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({error: error.message}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
