<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Monitoring Skripsi</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <style>
    :root {
      --primary: #2c3e50;
      --secondary: #3498db;
      --accent: #e74c3c;
      --light: #ecf0f1;
      --dark: #2c3e50;
      --success: #2ecc71;
      --warning: #f39c12;
      --danger: #e74c3c;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background-color: #f5f7fa;
      color: #333;
      line-height: 1.6;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    header {
      background-color: var(--primary);
      color: white;
      padding: 20px 0;
      text-align: center;
      border-radius: 8px 8px 0 0;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    h1 {
      font-size: 28px;
      margin-bottom: 10px;
    }
    
    .description {
      font-size: 16px;
      opacity: 0.9;
    }
    
    .tabs {
      display: flex;
      flex-wrap: wrap;
      margin-bottom: 20px;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .tab {
      padding: 12px 20px;
      cursor: pointer;
      background: #f8f9fa;
      border: none;
      border-bottom: 3px solid transparent;
      font-weight: 600;
      transition: all 0.3s ease;
      flex-grow: 1;
      text-align: center;
    }
    
    .tab:hover {
      background: #e9ecef;
      border-bottom: 3px solid var(--secondary);
    }
    
    .tab.active {
      background: white;
      border-bottom: 3px solid var(--secondary);
      color: var(--secondary);
    }
    
    .tab-content {
      display: none;
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }
    
    .tab-content.active {
      display: block;
      animation: fadeIn 0.5s;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
      transition: transform 0.3s ease;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
    }
    
    .stat-card h3 {
      font-size: 16px;
      color: #6c757d;
      margin-bottom: 10px;
    }
    
    .stat-card .value {
      font-size: 32px;
      font-weight: bold;
      color: var(--primary);
    }
    
    .chart-container {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }
    
    .chart-title {
      font-size: 18px;
      margin-bottom: 15px;
      color: var(--dark);
      text-align: center;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    th, td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #e9ecef;
    }
    
    th {
      background-color: var(--primary);
      color: white;
      font-weight: 600;
    }
    
    tr:hover {
      background-color: #f8f9fa;
    }
    
    .loading {
      text-align: center;
      padding: 40px;
      color: #6c757d;
    }
    
    .error {
      background: #ffecec;
      color: var(--danger);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      border-left: 4px solid var(--danger);
    }
    
    footer {
      text-align: center;
      margin-top: 40px;
      padding: 20px;
      color: #6c757d;
      font-size: 14px;
    }
    
    @media (max-width: 768px) {
      .tab {
        flex: 0 0 50%;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 480px) {
      .tab {
        flex: 0 0 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Dashboard Monitoring Skripsi</h1>
      <p class="description">Sistem Informasi Monitoring Progress Skripsi Mahasiswa</p>
    </header>
    
    <div class="tabs">
      <button class="tab active" onclick="openTab('totalSkripsi')">TOTAL SKRIPSI</button>
      <button class="tab" onclick="openTab('tahunIni')">TAHUN INI</button>
      <button class="tab" onclick="openTab('ekonomiSyariah')">EKONOMI SYARIAH</button>
      <button class="tab" onclick="openTab('perbankanSyariah')">PERBANKAN SYARIAH</button>
      <button class="tab" onclick="openTab('manajemenBisnisSyariah')">MANAJEMEN BISNIS SYARIAH</button>
      <button class="tab" onclick="openTab('similarity')">SIMILARITY</button>
      <button class="tab" onclick="openTab('bimbingan')">BIMBINGAN</button>
      <button class="tab" onclick="openTab('skripsiFinal')">SKRIPSI FINAL</button>
      <button class="tab" onclick="openTab('earlyWarning')">EARLY WARNING</button>
      <button class="tab" onclick="openTab('skripsi')">SKRIPSI</button>
    </div>
    
    <div id="totalSkripsi" class="tab-content active">
      <h2>Total Skripsi</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Total Judul Skripsi</h3>
          <div class="value">245</div>
        </div>
        <div class="stat-card">
          <h3>Skripsi Selesai</h3>
          <div class="value">178</div>
        </div>
        <div class="stat-card">
          <h3>Dalam Proses</h3>
          <div class="value">67</div>
        </div>
        <div class="stat-card">
          <h3>Tingkat Penyelesaian</h3>
          <div class="value">72.7%</div>
        </div>
      </div>
      
      <div class="chart-container">
        <div class="chart-title">Distribusi Skripsi per Program Studi</div>
        <canvas id="prodiChart"></canvas>
      </div>
      
      <div class="chart-container">
        <div class="chart-title">Progress Skripsi per Tahun</div>
        <canvas id="tahunChart"></canvas>
      </div>
    </div>
    
    <div id="tahunIni" class="tab-content">
      <h2>Skripsi Tahun Ini</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Skripsi Tahun Ini</h3>
          <div class="value">42</div>
        </div>
        <div class="stat-card">
          <h3>Sudah Selesai</h3>
          <div class="value">28</div>
        </div>
        <div class="stat-card">
          <h3>Dalam Bimbingan</h3>
          <div class="value">14</div>
        </div>
        <div class="stat-card">
          <h3>Perkiraan Selesai</h3>
          <div class="value">85%</div>
        </div>
      </div>
      
      <div class="chart-container">
        <div class="chart-title">Status Skripsi Tahun Ini</div>
        <canvas id="tahunIniChart"></canvas>
      </div>
    </div>
    
    <div id="ekonomiSyariah" class="tab-content">
      <h2>Ekonomi Syariah</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Total Skripsi</h3>
          <div class="value">98</div>
        </div>
        <div class="stat-card">
          <h3>Sudah Selesai</h3>
          <div class="value">75</div>
        </div>
        <div class="stat-card">
          <h3>Dalam Proses</h3>
          <div class="value">23</div>
        </div>
        <div class="stat-card">
          <h3>Tingkat Penyelesaian</h3>
          <div class="value">76.5%</div>
        </div>
      </div>
      
      <div class="chart-container">
        <div class="chart-title">Topik Skripsi Ekonomi Syariah</div>
        <canvas id="ekonomiChart"></canvas>
      </div>
    </div>
    
    <div id="perbankanSyariah" class="tab-content">
      <h2>Perbankan Syariah</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Total Skripsi</h3>
          <div class="value">87</div>
        </div>
        <div class="stat-card">
          <h3>Sudah Selesai</h3>
          <div class="value">64</div>
        </div>
        <div class="stat-card">
          <h3>Dalam Proses</h3>
          <div class="value">23</div>
        </div>
        <div class="stat-card">
          <h3>Tingkat Penyelesaian</h3>
          <div class="value">73.6%</div>
        </div>
      </div>
      
      <div class="chart-container">
        <div class="chart-title">Topik Skripsi Perbankan Syariah</div>
        <canvas id="perbankanChart"></canvas>
      </div>
    </div>
    
    <div id="manajemenBisnisSyariah" class="tab-content">
      <h2>Manajemen Bisnis Syariah</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Total Skripsi</h3>
          <div class="value">60</div>
        </div>
        <div class="stat-card">
          <h3>Sudah Selesai</h3>
          <div class="value">39</div>
        </div>
        <div class="stat-card">
          <h3>Dalam Proses</h3>
          <div class="value">21</div>
        </div>
        <div class="stat-card">
          <h3>Tingkat Penyelesaian</h3>
          <div class="value">65%</div>
        </div>
      </div>
      
      <div class="chart-container">
        <div class="chart-title">Topik Skripsi Manajemen Bisnis Syariah</div>
        <canvas id="manajemenChart"></canvas>
      </div>
    </div>
    
    <div id="similarity" class="tab-content">
      <h2>Similarity Check</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Rata-rata Similarity</h3>
          <div class="value">14.2%</div>
        </div>
        <div class="stat-card">
          <h3>Di Bawah 15%</h3>
          <div class="value">68%</div>
        </div>
        <div class="stat-card">
          <h3>15% - 25%</h3>
          <div class="value">24%</div>
        </div>
        <div class="stat-card">
          <h3>Diatas 25%</h3>
          <div class="value">8%</div>
        </div>
      </div>
      
      <div class="chart-container">
        <div class="chart-title">Distribusi Tingkat Similarity</div>
        <canvas id="similarityChart"></canvas>
      </div>
    </div>
    
    <div id="bimbingan" class="tab-content">
      <h2>Data Bimbingan</h2>
      <div class="loading">Memuat data bimbingan...</div>
    </div>
    
    <div id="skripsiFinal" class="tab-content">
      <h2>Data Skripsi Final</h2>
      <div class="loading">Memuat data skripsi final...</div>
    </div>
    
    <div id="earlyWarning" class="tab-content">
      <h2>Data Early Warning</h2>
      <div class="loading">Memuat data early warning...</div>
    </div>
    
    <div id="skripsi" class="tab-content">
      <h2>Data Skripsi</h2>
      <div class="loading">Memuat data skripsi...</div>
    </div>
    
    <footer>
      <p>© 2023 Sistem Monitoring Skripsi - Universitas Example</p>
    </footer>
  </div>

  <script>
    // Fungsi untuk berpindah tab
    function openTab(tabName) {
      // Sembunyikan semua tab content
      var tabContents = document.getElementsByClassName("tab-content");
      for (var i = 0; i < tabContents.length; i++) {
        tabContents[i].classList.remove("active");
      }
      
      // Nonaktifkan semua tab
      var tabs = document.getElementsByClassName("tab");
      for (var i = 0; i < tabs.length; i++) {
        tabs[i].classList.remove("active");
      }
      
      // Aktifkan tab yang dipilih
      document.getElementById(tabName).classList.add("active");
      
      // Temukan tombol tab yang sesuai dan aktifkan
      var tabButtons = document.getElementsByClassName("tab");
      for (var i = 0; i < tabButtons.length; i++) {
        if (tabButtons[i].getAttribute("onclick").includes(tabName)) {
          tabButtons[i].classList.add("active");
          break;
        }
      }
      
      // Jika tab yang dipilih adalah tab dengan data dari spreadsheet, muat data
      if (['bimbingan', 'skripsiFinal', 'earlyWarning', 'skripsi'].includes(tabName)) {
        loadData(tabName);
      }
    }
    
    // Fungsi untuk memuat data dari Google Apps Script
    function loadData(tabName) {
      const actionMap = {
        'bimbingan': 'getBimbingan',
        'skripsiFinal': 'getSkripsiFinal',
        'earlyWarning': 'getEarlyWarning',
        'skripsi': 'getSkripsi'
      };
      
      const action = actionMap[tabName];
      const url = `https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec?action=${action}`;
      
      const contentDiv = document.getElementById(tabName);
      contentDiv.innerHTML = '<div class="loading">Memuat data...</div>';
      
      fetch(url)
        .then(response => response.json())
        .then(data => {
          if (data.error) {
            contentDiv.innerHTML = `<div class="error">Error: ${data.error}</div>`;
            return;
          }
          
          if (data.length === 0) {
            contentDiv.innerHTML = '<div class="loading">Tidak ada data ditemukan</div>';
            return;
          }
          
          // Buat tabel dari data
          let tableHtml = '<table><thead><tr>';
          
          // Header tabel
          Object.keys(data[0]).forEach(key => {
            tableHtml += `<th>${key}</th>`;
          });
          tableHtml += '</tr></thead><tbody>';
          
          // Isi tabel
          data.forEach(row => {
            tableHtml += '<tr>';
            Object.values(row).forEach(value => {
              tableHtml += `<td>${value}</td>`;
            });
            tableHtml += '</tr>';
          });
          
          tableHtml += '</tbody></table>';
          contentDiv.innerHTML = tableHtml;
        })
        .catch(error => {
          contentDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
        });
    }
    
    // Inisialisasi chart ketika halaman dimuat
    document.addEventListener('DOMContentLoaded', function() {
      // Chart untuk distribusi program studi
      const prodiCtx = document.getElementById('prodiChart').getContext('2d');
      new Chart(prodiCtx, {
        type: 'pie',
        data: {
          labels: ['Ekonomi Syariah', 'Perbankan Syariah', 'Manajemen Bisnis Syariah'],
          datasets: [{
            data: [98, 87, 60],
            backgroundColor: ['#3498db', '#2ecc71', '#e74c3c']
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      });
      
      // Chart untuk progress per tahun
      const tahunCtx = document.getElementById('tahunChart').getContext('2d');
      new Chart(tahunCtx, {
        type: 'bar',
        data: {
          labels: ['2018', '2019', '2020', '2021', '2022', '2023'],
          datasets: [{
            label: 'Jumlah Skripsi',
            data: [32, 38, 45, 52, 48, 42],
            backgroundColor: '#3498db'
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
      
      // Chart untuk status skripsi tahun ini
      const tahunIniCtx = document.getElementById('tahunIniChart').getContext('2d');
      new Chart(tahunIniCtx, {
        type: 'doughnut',
        data: {
          labels: ['Selesai', 'Dalam Bimbingan', 'Belum Dimulai'],
          datasets: [{
            data: [28, 14, 0],
            backgroundColor: ['#2ecc71', '#f39c12', '#e74c3c']
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      });
      
      // Chart untuk topik ekonomi syariah
      const ekonomiCtx = document.getElementById('ekonomiChart').getContext('2d');
      new Chart(ekonomiCtx, {
        type: 'bar',
        data: {
          labels: ['Keuangan', 'Marketing', 'SDM', 'Operasional', 'Strategi'],
          datasets: [{
            label: 'Jumlah',
            data: [35, 28, 15, 12, 8],
            backgroundColor: '#3498db'
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
      
      // Chart untuk topik perbankan syariah
      const perbankanCtx = document.getElementById('perbankanChart').getContext('2d');
      new Chart(perbankanCtx, {
        type: 'bar',
        data: {
          labels: ['Perbankan', 'Fintech', 'Investasi', 'Asuransi', 'Lainnya'],
          datasets: [{
            label: 'Jumlah',
            data: [42, 18, 12, 9, 6],
            backgroundColor: '#2ecc71'
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
      
      // Chart untuk topik manajemen bisnis syariah
      const manajemenCtx = document.getElementById('manajemenChart').getContext('2d');
      new Chart(manajemenCtx, {
        type: 'bar',
        data: {
          labels: ['Manajemen', 'Bisnis', 'Pemasaran', 'Keuangan', 'Lainnya'],
          datasets: [{
            label: 'Jumlah',
            data: [25, 18, 10, 5, 2],
            backgroundColor: '#e74c3c'
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
      
      // Chart untuk distribusi similarity
      const similarityCtx = document.getElementById('similarityChart').getContext('2d');
      new Chart(similarityCtx, {
        type: 'bar',
        data: {
          labels: ['<10%', '10-15%', '15-20%', '20-25%', '>25%'],
          datasets: [{
            label: 'Jumlah Skripsi',
            data: [85, 82, 45, 25, 8],
            backgroundColor: '#f39c12'
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    });
  </script>
</body>
</html>
